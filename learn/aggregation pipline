[
  {
    "$lookup": {
      "from": "author",
      "localField": "author_id",
      "foreignField": "id",
      "as": "author_details"
    }
  },
  {
    $addFields: {
      author_details: {
        $arrayElemAt : ["$author_details", 0]
        },
    }
  }
]

You have Users collection:

{ "_id": "USER1001", "username": "john" }


You have Subscriptions collection:

{ "subscriber": "USER2001", "channel": "USER1001" }
{ "subscriber": "USER2002", "channel": "USER1001" }

from → the collection you want to join (subscriptions)

localField → field in the current collection (User._id)

foreignField → field in the other collection (subscriptions.channel)

as → output array to store the joined documents

to connect one fileds to other and also inherit from others;

| Stage              | Purpose                                              |
| ------------------ | ---------------------------------------------------- |
| `$match`           | Filters documents (like SQL `WHERE`)                 |
| `$group`           | Groups data (like SQL `GROUP BY`)                    |
| `$sort`            | Sorts the results                                    |
| `$project`         | Selects or reshapes fields (like SQL `SELECT`)       |
| `$limit` / `$skip` | Limits or skips a number of documents                |
| `$lookup`          | Joins data from another collection (like SQL `JOIN`) |
| `$unwind`          | Deconstructs array fields into multiple documents    |
| `$count`           | Counts the number of documents in the pipeline       |
| `$addFields`       | Adds new computed fields                             |
| `$out`             | Writes the result into a new collection              |
